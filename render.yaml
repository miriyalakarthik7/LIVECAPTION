services:
  # Backend Service (Docker)
  - type: web
    name: livecaption-backend
    env: docker
    plan: free
    region: oregon
    envVars:
      - key: PORT
        value: "8000"
    healthCheckPath: /docs
    autoDeploy: true

  # Frontend Service (Static Site)
  - type: static
    name: livecaption-frontend
    env: static
    buildCommand: npm install && npm run build
    publishDir: dist
    root: Frontend/CaptionDisplay
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
    envVars:
      - key: VITE_WEBSOCKET_URL
        fromService:
          type: web
          name: livecaption-backend
          property: host
          # Note: Websockets need ws:// or wss://. Render service host usually returns just the domain.
          # We might need to manually set this in the Render Dashboard if direct linking doesn't prepend wss://
          # For now, we will assume user will set this or we format it.
          # Since Render variables are simple strings, we might need to rely on the user adding it in the dashboard 
          # OR use a placeholder value that the user updates.
          # Better: Let's assume the user will configure the Environment Variable manually in Render Dashboard 
          # because constructing "wss://..." dynamically here is tricky without knowing the full https domain scheme confidently.
          # BUT, we can try to link it.
      - key: VITE_WEBSOCKET_URL
        value: wss://livecaption-backend.onrender.com/ws/transcribe
        # User should update 'livecaption-backend' with their actua service name if different
